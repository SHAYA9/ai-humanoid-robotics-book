"use strict";(globalThis.webpackChunkai_humanoid_robotics_book_new=globalThis.webpackChunkai_humanoid_robotics_book_new||[]).push([[5474],{4454:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var o=s(6540),n=s(8691);const i="https://rag-chatbot.koyeb.app";var a=s(4848);const c=()=>{const[e,t]=(0,o.useState)([]),[s,n]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{(async()=>{try{const e=await(async()=>{const e=await fetch(`${i}/chat/history`);if(!e.ok)throw new Error("Failed to fetch chat history");return e.json()})();t(e.history)}catch(e){console.error("Failed to fetch history:",e)}finally{n(!1)}})()},[]),s?(0,a.jsx)("p",{children:"Loading history..."}):(0,a.jsxs)("div",{className:"history-container",children:[(0,a.jsx)("h3",{children:"Conversation History"}),0===e.length?(0,a.jsx)("p",{children:"No history yet."}):(0,a.jsx)("ul",{children:e.map((e,t)=>(0,a.jsxs)("li",{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"You:"})," ",e.question]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Bot:"})," ",e.answer]}),e.sources&&(0,a.jsxs)("small",{children:["Sources: ",e.sources]})]},t))})]})},r=({sources:e})=>e?(0,a.jsxs)("div",{className:"citations",children:[(0,a.jsx)("strong",{children:"Sources:"})," ",e]}):null,l=({selectedText:e})=>{const[t,s]=(0,o.useState)(""),[n,l]=(0,o.useState)(""),[h,d]=(0,o.useState)(""),[u,x]=(0,o.useState)(!1),[j,p]=(0,o.useState)("");(0,o.useEffect)(()=>{e&&s(`What about "${e}"?`)},[e]);return(0,a.jsxs)("div",{className:"chat-container",children:[(0,a.jsx)("h2",{children:"RAG Chatbot"}),(0,a.jsxs)("div",{className:"chat-box",children:[(0,a.jsx)("textarea",{value:t,onChange:e=>s(e.target.value),placeholder:"Ask a question about the selected text or anything else...",rows:"3"}),(0,a.jsx)("button",{onClick:async()=>{if(t.trim()){x(!0),p(""),l(""),d("");try{const s=await(async(e,t)=>{const s=await fetch(`${i}/chat/selected`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e,context:t})});if(!s.ok)throw new Error("API request failed");return s.json()})(t,e);l(s.answer),d(s.sources)}catch(s){p("Failed to get an answer. Please try again.")}finally{x(!1)}}},disabled:u,children:u?"Thinking...":"Ask"})]}),j&&(0,a.jsx)("p",{className:"error",children:j}),n&&(0,a.jsxs)("div",{className:"response-box",children:[(0,a.jsx)("h3",{children:"Answer:"}),(0,a.jsx)("p",{children:n}),(0,a.jsx)(r,{sources:h})]}),(0,a.jsx)(c,{})]})},h=({children:e})=>{const[t,s]=(0,o.useState)(""),[n,i]=(0,o.useState)({top:0,left:0});return(0,a.jsxs)("div",{onMouseUp:()=>{const e=window.getSelection().toString();if(e){const t=window.getSelection().getRangeAt(0).getBoundingClientRect();s(e),i({top:t.bottom+window.scrollY,left:t.left+window.scrollX})}else s("")},children:[t&&(0,a.jsx)("div",{style:{position:"absolute",top:`${n.top}px`,left:`${n.left}px`,zIndex:1e3},children:(0,a.jsx)("button",{className:"ask-button",onClick:()=>{console.log("Selected Text:",t)},children:"Ask about this"})}),o.cloneElement(e,{selectedText:t})]})};const d=function(){return(0,a.jsx)(n.A,{title:"Chatbot",description:"Chat with the AI Humanoid Robotics Book assistant",children:(0,a.jsxs)("div",{style:{padding:"2rem"},children:[(0,a.jsx)("h1",{children:"AI Humanoid Robotics Book Chatbot"}),(0,a.jsx)("p",{children:"Welcome! You can ask general questions or select text from any page in the book to ask a specific question about it."}),(0,a.jsx)(h,{children:(0,a.jsx)(l,{})})]})})}}}]);